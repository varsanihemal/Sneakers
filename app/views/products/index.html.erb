<h1>Products</h1>

<div class="products">
  <% @products.each do |product| %>
    <div class="product">
      <%= link_to product_path(product) do %>
        <%= image_tag product.image_url, alt: product.name, class: "product-image" if product.image_url.present? %>
        <h2><%= product.name %></h2>
        <p><%= number_to_currency(product.price) %></p>
      <% end %>

      <!-- Form to add the product to the cart -->
      <%= form_with(url: cart_items_path, method: :post, local: true) do |form| %>
        <%= form.hidden_field :product_id, value: product.id %>
        <%= form.number_field :quantity, min: 1, value: 1 %>
        <%= form.hidden_field :cart_id, value: current_user.cart.id %>
        <%= form.submit "Add to Cart" %>
      <% end %>
    </div>
  <% end %>
</div>

<%= paginate @products %>
